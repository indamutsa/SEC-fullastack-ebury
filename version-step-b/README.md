# Secure File Uploader API

This project provides a secure API for uploading files, designed with a focus on security and efficiency. It leverages FastAPI for the web framework, Redis for rate limiting, and includes security headers and CORS middleware for enhanced security measures.

## Features

- **Secure File Upload**: Provides an API endpoint for securely uploading files with validation and sanitation.
- **Rate Limiting**: Integrates rate limiting to prevent abuse using Redis.
- **Security Enhancements**: Implements several security headers and CORS policy for improved application security.
- **Static File Serving**: Serves uploaded files securely through a dedicated endpoint.

## Installation

To run this application, ensure you have Python 3.6 or later and Docker installed on your machine. Follow these steps to set up the project:

```bash
git clone https://github.com/indamutsa/SEC-fullastack-ebury.git
cd SEC-fullastack-ebury
```

The project structure is as follows:

```plaintext
❯ tree -L 2 .
.
├── README.md
├── backend
│   ├── README.md
│   ├── __pycache__
│   ├── controller
│   ├── fileServer.py
│   ├── models
│   ├── pyenv
│   ├── requirements.txt
│   ├── service
│   ├── test
│   ├── test.db
│   ├── uploads
│   └── utils
└── web
    ├── script.js
    ├── style.css
    └── upload.html

11 directories, 8 files
```

### Setting Up a Working Container

Refer to the [working-container.md](../working-container.md) guide to initialize your Docker container environment. This setup ensures that no direct installations are required on your local machine, except for Docker.

### Preparing the Environment

Create and activate a virtual environment:

```bash
python3 -m venv pyenv
source pyenv/bin/activate
```

Ensure your virtual environment is correctly set up:

```bash
which python # should point to the virtual environment's Python
python --version # Verify the Python version
```

Install project dependencies:

```bash
pip install -r requirements.txt
```

## Usage

Before running the API, ensure Redis is running locally or adjust the Redis connection URL in the `lifespan` function to match your Redis instance.

Start the API with Uvicorn:

```bash
uvicorn fileServer:app --reload
```

You can now upload files through the `/uploads` endpoint and access uploaded files via the `/uploads/{filename}` path.

## Configuration

- **Redis Connection**: Configured to `redis://localhost:6379` by default. Modify this in the `lifespan` async context manager for different setups.
- **Rate Limiting**: Adjust the rate limiting settings in `FastAPILimiter.init` as necessary for your application's needs.
- **Security Settings**: Review and adjust security headers in the `SecurityHeadersMiddleware` class as required for your deployment.

For detailed API usage and endpoint documentation, refer to the autogenerated FastAPI documentation available at `http://localhost:8000/docs` once the server is running.
